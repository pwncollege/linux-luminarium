#!/opt/pwn.college/bash
# HARDENED-PATH
set -euo pipefail
IFS=' 	
'
unalias -a 2>/dev/null || true
unset BASH_ENV ENV CDPATH SHELLOPTS EDITOR VISUAL PAGER SYSTEMD_PAGER LESSOPEN GIT_EDITOR GIT_PAGER LD_PRELOAD LD_LIBRARY_PATH
PATH="/usr/sbin:/usr/bin:/sbin:/bin"; export PATH
umask 022

FLAG=$(/bin/cat /flag)
FLAG_CONTENT=$(sed 's/pwn\.college{\(.*\)}/\1/' <<< "$FLAG")

# Generate 1000+ lines with decoys and the real flag
REAL_FLAG_LINE=$((RANDOM % 1000 + 1))

for i in {1..1200}; do
    if [ $i -eq $REAL_FLAG_LINE ]; then
        # Print the real flag
        echo "$FLAG"
    else
        echo -n "pwn.college{"
        while read -n1; do echo ${REPLY:-DECOY}; done <<< "$FLAG_CONTENT" | tail -n+6 | shuf | tr -d "\n"
        echo "}"
    fi
done
