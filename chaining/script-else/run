#!/opt/pwn.college/bash
# HARDENED-PATH
set -euo pipefail
IFS=' 	
'
unalias -a 2>/dev/null || true
unset BASH_ENV ENV CDPATH SHELLOPTS EDITOR VISUAL PAGER SYSTEMD_PAGER LESSOPEN GIT_EDITOR GIT_PAGER LD_PRELOAD LD_LIBRARY_PATH
PATH="/usr/sbin:/usr/bin:/sbin:/bin"; export PATH
umask 022

SCRIPT_PATH="/home/hacker/solve.sh"

if [ ! -f "$SCRIPT_PATH" ]; then
    echo "Error: You need to create a script at $SCRIPT_PATH"
    exit 1
fi

TEST_CASES=(
    "pwn:college"
    "hack:nope"
    "foo:nope"
    "bar:nope"
    "anything:nope"
)

for test_case in "${TEST_CASES[@]}"; do
    INPUT="${test_case%%:*}"
    EXPECTED="${test_case#*:}"
    
    OUTPUT=$(su -c "bash \"$SCRIPT_PATH\" \"$INPUT\" 2>&1" hacker)
    
    if [ "$OUTPUT" != "$EXPECTED" ]; then
        echo "Test failed for input '$INPUT'"
        echo "Expected: '$EXPECTED'"
        echo "Got: '$OUTPUT'"
        exit 1
    fi
done

echo "Correct! Your script properly handles the if/else conditions."
echo "Here's your flag:"
/bin/cat /flag